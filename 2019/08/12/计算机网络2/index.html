<!DOCTYPE html>





<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    save_scroll: false,
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    }
  };
</script>

  <meta name="description" content="传输层传送层的特点是什么?用来解决那些问题?有哪些主要特点?在这中间又出现了什么情况? 基础知识 传输层提供应用之间的逻辑通信,使应用之间可以忽略下层的数据和协议,看起来是两个应用之间直接进行沟通. 网络层提供不同主机之间的沟通.传输层提供不用应用间的沟通. 传输层分TCP协议和udp协议.udp不需要建立链接,是不可靠交付,但报文简单效率高,用于视频游戏等.tcp需要建立链接,提供可靠服务,但是">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络2">
<meta property="og:url" content="http://yoursite.com/2019/08/12/计算机网络2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="传输层传送层的特点是什么?用来解决那些问题?有哪些主要特点?在这中间又出现了什么情况? 基础知识 传输层提供应用之间的逻辑通信,使应用之间可以忽略下层的数据和协议,看起来是两个应用之间直接进行沟通. 网络层提供不同主机之间的沟通.传输层提供不用应用间的沟通. 传输层分TCP协议和udp协议.udp不需要建立链接,是不可靠交付,但报文简单效率高,用于视频游戏等.tcp需要建立链接,提供可靠服务,但是">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/006tNc79ly1g5wq1xikd0j30g009k3z5-20190812113315349.jpg">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812200109991.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812200134814.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812200236105.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812200458541.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812204134917.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812205906050.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812211730005.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812214144310.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812220548367.png">
<meta property="og:image" content="http://yoursite.com/2019/08/12/计算机网络2/image-20190812232152780.png">
<meta property="og:updated_time" content="2019-08-12T15:37:26.364Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="计算机网络2">
<meta name="twitter:description" content="传输层传送层的特点是什么?用来解决那些问题?有哪些主要特点?在这中间又出现了什么情况? 基础知识 传输层提供应用之间的逻辑通信,使应用之间可以忽略下层的数据和协议,看起来是两个应用之间直接进行沟通. 网络层提供不同主机之间的沟通.传输层提供不用应用间的沟通. 传输层分TCP协议和udp协议.udp不需要建立链接,是不可靠交付,但报文简单效率高,用于视频游戏等.tcp需要建立链接,提供可靠服务,但是">
<meta name="twitter:image" content="http://yoursite.com/2019/08/12/计算机网络2/006tNc79ly1g5wq1xikd0j30g009k3z5-20190812113315349.jpg">
  <link rel="canonical" href="http://yoursite.com/2019/08/12/计算机网络2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>计算机网络2 | Hexo</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  <div class="container sidebar-position-left">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content page-post-detail">
            

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/12/计算机网络2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">计算机网络2

            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-08-12 11:08:46 / Modified: 23:37:26" itemprop="dateCreated datePublished" datetime="2019-08-12T11:08:46+08:00">2019-08-12</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h1><p>传送层的特点是什么?用来解决那些问题?有哪些主要特点?在这中间又出现了什么情况?</p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><ul>
<li>传输层提供应用之间的逻辑通信,使应用之间可以忽略下层的数据和协议,看起来是两个应用之间直接进行沟通.</li>
<li>网络层提供不同主机之间的沟通.传输层提供不用应用间的沟通.</li>
<li>传输层分TCP协议和udp协议.udp不需要建立链接,是不可靠交付,但报文简单效率高,用于视频游戏等.tcp需要建立链接,提供可靠服务,但是开销大,占用资源多.适用于邮件,通信等.</li>
<li>每个应用在主机中有特定的端口,传输层通过端口将数据发送给应用进程.这是一种软件指定的端口.端口只对计算机本地有用.端口号从0-65536,16位</li>
</ul>
<h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>udp 是无连接的,发送方不管接收方是否能收到.</li>
<li>udp使用尽最大努力交付.但不保证一定能收到.这使主机不用维持负责的连接状态</li>
<li>udp是面向报文的,应用层发下来的报文,udp加上首部就向下转发,不进行别的处理.类似把应用层的报文透传给网络层</li>
<li>udp没有拥塞控制,因此当网络拥挤时udp也同样按原来方式发送数据.不管是否能到达.</li>
<li>udp支持1对1,1对多,多对1,多对多的交互通信</li>
<li>udp首部只有8个字节,很小</li>
<li>udp在通信时不需要建立socket 套接字连接</li>
</ul>
<h3 id="udp格式"><a href="#udp格式" class="headerlink" title="udp格式"></a>udp格式</h3><p><img src="/2019/08/12/计算机网络2/006tNc79ly1g5wq1xikd0j30g009k3z5-20190812113315349.jpg" alt="image-20190812111337207"></p>
<ul>
<li><p>源端口,发送方进程的端口号,也是发送方接受消息的端口号</p>
</li>
<li><p>目的端口,接收方进程的端口号.</p>
</li>
<li><p>长度 udp用户数据报的长度,最小是8(只有首部)</p>
</li>
<li><p>校验和,检查udp用户数据报在传输中是否有错.会把首部和数据部分一起进行校验</p>
</li>
<li><p>伪首部,用来计算校验和而添加的数据,并不会真正封装到数据报中</p>
</li>
</ul>
<h2 id="tcp"><a href="#tcp" class="headerlink" title="tcp"></a>tcp</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><ul>
<li><p>tcp是面向连接的,因此会先建立tcp连接,在进行通信</p>
</li>
<li><p>tcp只能是点对点的通信,因为要先建立链接</p>
</li>
<li><p>tcp是可靠交付,保证接收端数据无差错不丢失不重复且按序到达</p>
</li>
<li><p>tcp提供全双工通信,允许双方任何时候都能发送数据,发送接收端都有缓存</p>
</li>
<li><p>tcp以流的方式传递数据.并不关心用户发送的是什么</p>
</li>
<li><p>tcp报文不需要用户控制长度,tcp自己会根据网络情况决定报文长度,而udp需要应用层设定报文长度.</p>
</li>
<li><p>tcp通过socket套接字进行连接, socket=(ip地址:端口号) 双方的socket就可以确定一条tcp连接.</p>
</li>
</ul>
<h3 id="Tcp可靠传输原理"><a href="#Tcp可靠传输原理" class="headerlink" title="Tcp可靠传输原理"></a>Tcp可靠传输原理</h3><p>停止等待协议,就是发送方每发送一个分组数据,就停止发送,等待接收方确认该分组到达.然后发送方再次发送.</p>
<p>这里又有几个问题.</p>
<h4 id="发送包丢失"><a href="#发送包丢失" class="headerlink" title="发送包丢失"></a>发送包丢失</h4><p>数据包没到达接收方就丢失,那么接收方不会有确认消息,发送方则在等待一段时间后进行重复,这要求1.发送方对分组进行缓存,直到收到确认消息.2.发送的数据报要有编号,知道哪个到达哪个丢失3.超时时间要设置合理.比数据传输的往返时间要长一点</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812200109991.png" alt="image-20190812200109991"></p>
<h4 id="确认包丢失"><a href="#确认包丢失" class="headerlink" title="确认包丢失"></a>确认包丢失</h4><p>接收方收到数据,返回的确认包丢失,则发送方会重复发送该包.再次收到时,接收方要丢弃新数据包(因为同样的已经收到了),并再次发送确认消息,防止发送方继续发送相同的包.</p>
<h4 id="确认迟到"><a href="#确认迟到" class="headerlink" title="确认迟到"></a>确认迟到</h4><p>确认方收到包,返回的确认消息超过了上边设定的超时时间.处理方式和2一样.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812200134814.png" alt="image-20190812200134814"></p>
<h4 id="信道利用率"><a href="#信道利用率" class="headerlink" title="信道利用率"></a>信道利用率</h4><p> 每次只发送一个包,在等待确认,导致信道空闲时间太长,利用率低.因此采用流水线方式,一次发送多个包,等待多个包的确认信息,在继续发送多个包.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812200236105.png" alt="image-20190812200236105"></p>
<h3 id="tcp报文格式"><a href="#tcp报文格式" class="headerlink" title="tcp报文格式"></a>tcp报文格式</h3><p><img src="/2019/08/12/计算机网络2/image-20190812200458541.png" alt="image-20190812200458541"></p>
<ul>
<li>源端口,目的端口 发送接收方的程序进程的端口号</li>
<li>序号,tcp是流的方式,每个字节都编号,本序号是指当前报文发送的数据的字节的序号(比如300表示发送的是第300字节开始的内容)用来告诉接收方本报文是哪段数据</li>
<li>确认号,接收方用来发送确认消息, 若确认号 =n,表示n以前的消息全部收到了</li>
<li>数据偏移: tcp首部长度.</li>
<li>ack 确认标识,当ack=1时确认号字段才有效.</li>
<li>urg 表示这是紧急报文.类似优先级,用来加快传输</li>
<li>push 接收方收到push标记,就尽快把数据交给上层应用而不等待接收缓存填满</li>
<li>syn 同步信号,建立链接时使用,表示这是链接请求(发送方)或链接同意(接收方)报文</li>
<li>fin 结束信号,用来中止链接</li>
<li>rst  复位信号,表示链接出错,需要断开重连</li>
<li>窗口,发送方通知接收方的.发送方能接受的数据量大小.</li>
<li>检验和,验证首部和数据</li>
<li>填充字段,添加一些可选选项,如最大报文长度MSS,窗口扩大选项,时间戳等.</li>
</ul>
<h3 id="tcp可靠传输实现"><a href="#tcp可靠传输实现" class="headerlink" title="tcp可靠传输实现"></a>tcp可靠传输实现</h3><h4 id="滑动窗口"><a href="#滑动窗口" class="headerlink" title="滑动窗口"></a>滑动窗口</h4><p>滑动窗口就是朝一个方向(数据方向)不断移动的数据报序号窗口,指允许同时发送的数据的范围.把数据想象成链式的,A发消息给B.当收到B的确认消息后,A不断的向前推进发送窗口.当网络比较好时,滑动窗口会增大,网络不好时滑动窗口会变小.窗口的后沿由B的确认消息的序号决定,前沿又网络状态决定.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812204134917.png" alt="image-20190812204134917"></p>
<p>发送方将数据不断发送,确认方不断把确认信息通知发送方,那么AB的后延后再向前走,而前沿由后沿和窗口的容量所决定,未确认的信息仍需要保存在滑动窗口中.</p>
<h4 id="超时重传的时间选择"><a href="#超时重传的时间选择" class="headerlink" title="超时重传的时间选择"></a>超时重传的时间选择</h4><p>tcp会保存数据包发出时间到收到响应时间的差,称作RTT,就是报文往返时间,超时重传时间会比RTT长一些.并且进行了一些加权运算.</p>
<h4 id="选择确认SACK"><a href="#选择确认SACK" class="headerlink" title="选择确认SACK"></a>选择确认SACK</h4><p>如果接收方接受到的数据,缺了中间某些部分,又不想把中间以后的部分都重传,就使用选择确认,可以指定最多4个字节块缺失.用来要求发送方进行局部信息的重传.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812205906050.png" alt="image-20190812205906050"></p>
<h3 id="tcp流量控制"><a href="#tcp流量控制" class="headerlink" title="tcp流量控制"></a>tcp流量控制</h3><p>让发送方发送速率不要太快.使接收方能够来得及接受而不至把数据包丢弃.通过滑动窗口来控制.</p>
<p>发送方的发送窗口不能超过接收方的接收窗口,tcp首部中窗口字段用来通知对方,自己的接收窗口有多大.</p>
<h3 id="tcp的拥塞控制"><a href="#tcp的拥塞控制" class="headerlink" title="tcp的拥塞控制"></a>tcp的拥塞控制</h3><p>拥塞就是对网络中某一资源的需求超过该资源能提供的.类似节假日高速免费.车辆超过高速的承载能力,会再入口堵塞,路上行驶变慢.对应网络来说.当发生拥塞时,确认报文可能会超时或丢失,此时tcp在进行超时重传,是没用的.只会恶化网络拥塞.</p>
<p>解决办法就是防止过多的数据注入网络,减少链路过载.</p>
<h4 id="慢开始"><a href="#慢开始" class="headerlink" title="慢开始"></a>慢开始</h4><p>​    发送方维持一个拥塞窗口的变量.控制同一时间发送数据量.发送方让发送窗口等于拥塞窗口,开始是设置拥塞窗口比较小,随着发送数据逐渐增大拥塞窗口,提示发送效率.规则是每收到一个确认消息.拥塞窗口加1个报文段长度.所以是指数性的增大1.2.4.8..</p>
<p>简单说就是初始拥塞窗口为1.网络正常时指数型增大拥塞窗口,当网络拥堵时,要再次初始化拥塞窗口.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812211730005.png" alt="image-20190812211730005"></p>
<h4 id="拥塞避免"><a href="#拥塞避免" class="headerlink" title="拥塞避免"></a>拥塞避免</h4><p>拥塞避免是使拥塞窗口增大的方式更缓慢一些,而不是慢开始那种指数级的增长,他是每经过一个RTT(一次报文发出到收到确认的往返时间)时间,就把拥塞窗口增大1个报文段长度.他是加法性增大 1.2.3.4.5</p>
<p>简单说就是根据往返时间线性增大拥塞窗口</p>
<h4 id="快重传"><a href="#快重传" class="headerlink" title="快重传"></a>快重传</h4><p>快重传是发送方要求接收方,每收到一个报文就立刻确认并且是确认最后有序的报文,那么假如发送方发了12345,而因为网络不好导致3丢失,接收方只收到1245,接收方就会发送 1.2.2.2.2.(因为最后有序的报文是2),当发送方收到3个重复的2确认时,知道3丢了.就重传3. 这种方式,不需要要等到超时时才知道3丢失.因此提高网络吞吐量.</p>
<p>简单说就是加快确认信息,提前知道丢包</p>
<h4 id="快恢复"><a href="#快恢复" class="headerlink" title="快恢复"></a>快恢复</h4><p>发送快重传后,不在使用慢开始把拥塞窗口设置为1(因为快重传并不意味着网络拥塞,否则确认信息也不可能及时到达)而是把拥塞窗口设置的高一点(如原来的一半),让拥塞窗口恢复的快一点.</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812214144310.png" alt="image-20190812214144310"></p>
<h4 id="主动队列管理"><a href="#主动队列管理" class="headerlink" title="主动队列管理"></a>主动队列管理</h4><p>网络层的路由器是有缓存的,可以存储一部分ip数据报,他采用队列方式, 先进先出.那么当要IP数据报太多时,缓存满了,就把后边的数据报都丢弃,这叫做尾部丢弃策略.但是tcp连接中,都是依赖ip层的传输,如果下层丢弃了很多数据报,上层的很多tcp过一段时间都知道了数据丢失,会认为是发生了网络拥塞,就会进行慢开始,降低拥塞窗口,这使得这一段时间网络通信突然下降.然后又指数级的增长.为了避免这种波段.路由器在队列快满的时候,随机的丢弃一些ip数据报,这使得上层的某些tcp进入慢开始,其他的还是正常传输,就减少了一段时间内的通信流量.</p>
<p>简单说就是网络层通过随机丢弃一些数据报,使传输层一些tcp减少传输速率,防止发生拥塞.</p>
<h3 id="tcp连接管理"><a href="#tcp连接管理" class="headerlink" title="tcp连接管理"></a>tcp连接管理</h3><p>连接分为建立链接,发生数据,断开连接三个阶段,建立链接需要解决三个问题,1双方要知道对方的存在2双方要商定一些参数如窗口大小.3能对传输的数据进行一些分配.</p>
<h4 id="建立链接"><a href="#建立链接" class="headerlink" title="建立链接"></a>建立链接</h4><p><img src="/2019/08/12/计算机网络2/image-20190812220548367.png" alt="image-20190812220548367"></p>
<ol>
<li>开始时,AB先创建传输控制模块TCB,然后B作为服务端进入监听状态</li>
<li>A先发送报文,syn=1的报文不携带数据.syn是同步信号,A进入syn-sent (同步已发送状态)</li>
<li>B同意建立链接,使syn和ack都为1,seq是序号,告诉对方当前是哪段数据.这段同样是对步骤1做出的确认信号,B进入syn-rcvd(同步已接收状态)</li>
<li>A在发送对步骤2的确认的信号,表示收到了B的确认信号(步骤2).A进入established(已建立链接状态)</li>
<li>B收到A的确认后,也进入established(已建立链接状态),可见,如果最后的报文没收到,B不会变成已连接状态.</li>
<li>为什么这样呢?加入A的第一个报文在某点延时了.A又发了一次报文1,B收到两个报文1,会发两次确认,如果等A的再次确认,就会建立2次连接,而A只需要建立一次连接,就使得B的一个连接资源浪费了.第三次确认是服务器把自己的建立链接的权利交给了对方.因为对方知道建立几个链接更合适.(就像你说买苹果,商家就一直装水果,一直往里装肯定不合适,他会问你够了吗?你说够了.然后就停止装水果.)</li>
</ol>
<h4 id="断开连接"><a href="#断开连接" class="headerlink" title="断开连接"></a>断开连接</h4><p>断开连接也称四次挥手,就是互相通知对方断开连接</p>
<p><img src="/2019/08/12/计算机网络2/image-20190812232152780.png" alt="image-20190812232152780"></p>
<ol>
<li><p>传输结束后,双方处于established(已建立链接状态),谁都可以选择释放连接</p>
</li>
<li><p>A向B发送链接释放报文,并停止发送数据,主动关闭tcp连接,A进入fin-wait-1(中止等待1)状态,fin报文不携带数据</p>
</li>
<li><p>B收到链接释放报文后,立刻发送确认消息,B进入close-wait(关闭等待)状态,tcp处于半关闭状态,A不能给B发数据,但B可以给A发数据,此时tcp会通知应用进程</p>
</li>
<li><p>A收到B的确认后,进入fin-wait-2(中止等待2)状态,等待B通知A关闭连接</p>
</li>
<li><p>如果B没有要发送的数据,应用进程会通知tcp释放链接,B就发送释放链接报文给A,用来关闭A的连接,B进入last-ack(最后确认)状态,等待A的确认.</p>
</li>
<li><p>A收到B发来的关闭连接状态后,会发出确认消息,然后进入time-wait(时间等待)状态.等待一段时间后,A进入close(关闭状态), msl叫最长报文段寿命,是一个时间.这是为了使A发出的确认报文能被B接受到,防止A关闭后,因网络阻塞,B没有收到确认,无法关闭.</p>
</li>
<li><p>B收到A的确认报文,进入关闭状态.</p>
</li>
</ol>
<p>简单说就是自己通知对方关闭连接,等对方发回确认信息后就进行关闭.稍有不同是A关闭后</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/08/11/计算机网络1/" rel="next" title="计算机网络1">
                  <i class="fa fa-chevron-left"></i> 计算机网络1
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
  </nav>



        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#传输层"><span class="nav-number">1.</span> <span class="nav-text">传输层</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础知识"><span class="nav-number">1.1.</span> <span class="nav-text">基础知识</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDP"><span class="nav-number">1.2.</span> <span class="nav-text">UDP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">1.2.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#udp格式"><span class="nav-number">1.2.2.</span> <span class="nav-text">udp格式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tcp"><span class="nav-number">1.3.</span> <span class="nav-text">tcp</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tcp可靠传输原理"><span class="nav-number">1.3.2.</span> <span class="nav-text">Tcp可靠传输原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#发送包丢失"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">发送包丢失</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#确认包丢失"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">确认包丢失</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#确认迟到"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">确认迟到</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#信道利用率"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">信道利用率</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp报文格式"><span class="nav-number">1.3.3.</span> <span class="nav-text">tcp报文格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp可靠传输实现"><span class="nav-number">1.3.4.</span> <span class="nav-text">tcp可靠传输实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#滑动窗口"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">滑动窗口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#超时重传的时间选择"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">超时重传的时间选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#选择确认SACK"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">选择确认SACK</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp流量控制"><span class="nav-number">1.3.5.</span> <span class="nav-text">tcp流量控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp的拥塞控制"><span class="nav-number">1.3.6.</span> <span class="nav-text">tcp的拥塞控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#慢开始"><span class="nav-number">1.3.6.1.</span> <span class="nav-text">慢开始</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#拥塞避免"><span class="nav-number">1.3.6.2.</span> <span class="nav-text">拥塞避免</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#快重传"><span class="nav-number">1.3.6.3.</span> <span class="nav-text">快重传</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#快恢复"><span class="nav-number">1.3.6.4.</span> <span class="nav-text">快恢复</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主动队列管理"><span class="nav-number">1.3.6.5.</span> <span class="nav-text">主动队列管理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp连接管理"><span class="nav-number">1.3.7.</span> <span class="nav-text">tcp连接管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#建立链接"><span class="nav-number">1.3.7.1.</span> <span class="nav-text">建立链接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#断开连接"><span class="nav-number">1.3.7.2.</span> <span class="nav-text">断开连接</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.3.0</div>

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    

  </div>

  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>


  <script src="/js/schemes/muse.js?v=7.3.0"></script>



<script src="/js/next-boot.js?v=7.3.0"></script>




  




























  

  

  


  
  <script src="/js/scrollspy.js?v=7.3.0"></script>
<script src="/js/post-details.js?v=7.3.0"></script>


</body>
</html>
